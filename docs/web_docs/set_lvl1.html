<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
  <title>Climate Prediction Center - wgrib2: -set_lvl1 and -set_lvl2</title>
  <meta http-equiv=Content-Type content="text/html; charset=windows-1252">
  <meta content="NCEP Web Team" name="GENERATOR">
  <meta name="keywords"
  content="Climate,Climate Prediction Center,National Weather Service,National Oceanic &amp; Atmospheric Administration, NOAA,El Nino,La Nina,ENSO,climate outlooks,El Nino Advisory,La Nina Advisory,droughts,hurricanes,Threats Assessment,Drought Assessment,Drought Monitor,CLimate Diagnostics Bulletin,6-10 day outlook,8-14 day outlook, 6-10 day forecast,8-14 day forecast,MRF,UV Index,North Atlantic Oscillation,NAO,Pacific Decadal Oscillation,PDO,sea surface temperatures,SST,Palmer Drought Severity Index, African Desk,outlooks,expert assessments,monitoring,advisories,stratosphere,temperature,precipitation,snow cover,snowfall,soil moisture,OLR,ozone,degree days,CLIMATE,CLIMATE PREDICTION CENTER,EL NINO,LA NINA, CLIMATE OUTLOOKS,HURRICANES,ASSESSMENTS,SNOW,STRATOSPHERE,DROUGHT,OZONE,DEGREE DAYS">
  <link href="/nwscwi/main.css" type="text/css" rel="STYLESHEET">
</head>
<body leftmargin="0" background="/nwscwi/background.gif" 
      topmargin="0" rightmargin="0" marginheight="0" marginwidth="0">
<table cellspacing="0" cellpadding="0" width="100%" background="/nwscwi/topbanner.jpg" border="0">
  <tr>
    <td align="right" height="19">
      <a href="#contents"><img height="1" alt="Skip Navigation Links"
         src="/nwscwi/skipgraphic.gif" width="1" border="0"></a>
      <a href="https://www.nws.noaa.gov/" class="homepagelinks"><span class="nwslink">www.nws.noaa.gov</span></a>&nbsp;</td>
  </tr>
</table>
<table cellspacing="0" cellpadding="0" width="100%" border="0">
  <tr>
    <td rowspan="2"><a href="https://www.noaa.gov/">
      <img height="78" alt="NOAA logo - Click to go to the NOAA home page"
      src="/nwscwi/noaaleft.jpg" width="85" border="0"></a></td>
    <td align="left"><img height="20" alt="National Weather Service"
      src="/nwscwi/nws_title.jpg" width="500" border="0"></td>
    <td rowspan="2" width="100%" background="/nwscwi/ncep_bkgrnd.jpg">&nbsp;</td>
    <td rowspan="2" align="right"><a href="https://www.nws.noaa.gov/">
      <img height="78" alt="NWS logo - Click to go to the NWS home page"
      src="/nwscwi/nwsright.jpg" width="85" border="0"></a></td>
  </tr>
  <tr>
    <td><img height="58" alt="Climate Prediction Center" src="/nwscwi/cpc.jpg"
             width="500" border="0"></td>    <!-- Put your center header image here. -->
  </tr>
</table>
<table cellspacing="0" cellpadding="0" width="100%" background="/nwscwi/navbkgrnd.gif" border="0">
  <tr>
    <td align="left" valign="top" width="94"><img height="23" alt="" src="/nwscwi/navbarleft.jpg" width
="94" border="0"></td>
    <td class="nav" align="center" width="15%">
      <a href="/products/site_index.html" class="menu">Site Map</a></td> <!-- Build a text only sitemap, and link to it via this
                                                    sitemap button just below the banner.
                                                    The sitemap should include a heirarchy of links
                                                    from NOAA, to the NWS, to NCEP, and then through your site. -->
    <td class="nav" align="right" width="15%">
      <a href="https://www.nws.noaa.gov/pa/" class="menu">News</a></td>
    <td class="nav" id="menuitem" align="right" width="20%">
      <a href="https://weather.gov/organization.php" class="menu">Organization</a></td>
    <td class="yellow" align="right" width="20%">
      <form action="https://www.firstgov.gov/fgsearch/index.jsp" name="query">
        <label for="search">Search</label>&nbsp;</td>
    <td align="left" class="searchinput" width="20%" nowrap>
      <input type="hidden" name="parsed" value="true">
      <input type="hidden" name="rn" value="3">
      <input type="hidden" name="in0" value="domain">
      <input type="hidden" name="dom0" value="nws.noaa.gov, weather.gov, wrh.noaa.gov, srh.noaa.gov, crh.noaa.gov, prh.noaa.gov, arh.noaa.gov, alaska.net/~nwsar, erh.noaa.gov, ncep.noaa.gov, wwb.noaa.gov, spc.noaa.gov, nhc.noaa.gov, sec.noaa.gov, aviationweather.gov, aviationweather.noaa.gov, weather.noaa.gov, roc.noaa.gov, nohrsc.nws.gov, nwstc.noaa.gov, wdtb.noaa.gov, npmoc.navy.mil, ndbc.noaa.gov">
      <input type="text" name="mw0" value="All NWS Search" id="search" size="20" maxlength="256">
      <input type="submit" name="Go2" value="Go"></td>
    <td width="10%">&nbsp;</form></td>
    <td align="right" valign="bottom" width="24"><img height="23" alt="" src="/nwscwi/navbarendcap.jpg"
 width="24" border="0"></td>
  </tr>
</table>
<table cellspacing="0" cellpadding="0" width="670" border="0">
  <tr valign="top">
    <td width="137"><br>
      <table cellspacing="0" cellpadding="2" width="137" border="0">
        <!-- Do not remove this section. You will need this when the City,St/zip search is implemented nationwide.-->
        <!-- <tr align="left" valign="top">
                <td class="searchinput">
                  <div id="Layer2" style="position:absolute; width:200px; height:115px; z-index:2; visibility: hidden">Search by city or zip code. Press enter or select the go button to submit request</div>
                  <form method="POST" action="https://www.srh.noaa.gov/zipcity.php">
                  <span class="yellow">Local forecast by<br>&quot;City, St&quot; or Zip Code</span><br>
                  <input type="text" name="inputstring" size="9" value="City, St">
                  <input type="submit" name="Go2" value="Go"></form></td>
        </tr> -->
         <tr>
          <td class="searchinput" align="left">
            <form action="https://www.firstgov.gov/fgsearch/index.jsp" name="query">
             <label for="search"><span class="yellow">CPC Search</span></label>
              <input type="hidden" name="parsed" value="true">
              <input type="hidden" name="rn" value="3">
              <input type="hidden" name="in0" value="domain">
              <input type="hidden" name="dom0" value="www.cpc.ncep.noaa.gov">
              <input type="text" name="mw0" id="search"  size="10" maxLength="256" value="CPC search">&nbsp;
              <input type="submit" name="Go2" value="Go">
          </form></td>
         </tr>
        <tr>
          <td class="white">
            <span class="yellow">About Us</span><br>
            &nbsp;&nbsp;&nbsp;<a href="/information/who_we_are/mission.html" class="menu">Our Mission</a><br>
            &nbsp;&nbsp;&nbsp;<a href="/information/who_we_are/" class="menu">Who We Are</a><br><br>
            <span class="yellow">Contact Us</span><br>
            &nbsp;&nbsp;&nbsp;<a href="/information/personnel/contacts.html" class="menu">CPC Information</a><br>
            &nbsp;&nbsp;&nbsp;<a href="/comment-form.html" class="menu">CPC Web Team</a><br><br>           
          </td>
        </tr>
      </table>
    </td>
    <td valign="top" align="center" width="533"><a name="contents"></a>

<!-- Begin content area -->

<table border="0" cellPadding="2" cellSpacing="0" align="center" width="533">
 <tr><td>&nbsp;</td></tr>
 <tr>
  <td>
   <font face="Verdana,arial,serif" size="1"><a href="/index.html" class="homepagelinks"><strong>HOME</strong></a> &gt; <a href="/products/monitoring_and_data" class="homepagelinks">Monitoring_and_Data</a> &gt; <a href="/products/monitoring_and_data/oadata.html" class="homepagelinks">Oceanic and Atmospheric Data</a> &gt; <a href="/products/wesley/" class="homepagelinks">Reanalysis: Atmospheric Data</a> &gt; wgrib2-set_lvl1,-set_lvl2</font>
  </td>
 </tr>
 <tr><td>&nbsp;</td></tr>
 <tr>
  <td>
<font color=red>
<h3 align=center>wgrib2: -set_lvl1, set-set_lvl2</h3>
</font>


<h3>Introduction: levels, should I use lev or lvl</h3>
<p>
The standard method of displaying and altering the level/layer metadata is by the
<font color=red>-lev</font> and <font color=red>-set_lev</font> options.
This method is high level and you don't need to know the details on how grib stores
the level/layer information.  The problems with a high level interface are when you
are using a new type of level information. Then the
<font color=red>-lev</font> and <font color=red>-set_lev</font> options don't help.
The "lvl" method is low level and are for cases when a high level interface doesn't work.

<h3>The Problem with Ambiguity of Numbers</h3>

The grib standard stores the level as a (signed 32-bit integer)*10**(signed 8-bit integer).
Nothing wrong with this format but numbers can be stored in multiple ways.  For example,

<pre>
   500 can be stored as 5*10**2
   500 can be stored as 50*10**1
   500 can be stored as 500*10**0
   500 can be stored as 5000*10**-1
</pre>

All are valid representations and libraries should treat them as equivalent.  
So if you search for the wind speed at "50 meters above the ground", you
should not have to worry wheter 50 is stored at 50*10**0 or 5*10**1 in
the grib file.  However, there are some libraries will only match one variant
of "50".  So to make your grib files compatible with this library,
you may have to use the "lvl" interface.  (With wgrib2, you match "50m above ground",
which independent of the internal respresentation.)

<p>
Another example of ambiguity is for "0.1 meters above the ground".  Now 0.1 is not 
a nice number when stored as a binary floating point number. You can only save an approximate
value when using a finite number of digits.  It is like 1/3 when written
as a decimal number. (1/3=0.3333333333333..)  
<pre>
  0.1 can be stored as 1*10**-1
  0.1 can be stored as 1000000015*10**-10
</pre>
Obviously the former is the preferred format but the latter is
the result trying to get the best scaled number for double
precision number "0.1".  

<p> The "lvl" interface can be used to remove ambiguities in the level information
using <font color=red>-set_lvl1</font> and <font color=red>-set_lvl2</font>.


<h3>lvl format</h3>


The "lvl" format is based on the grib standard.

<pre>
 1 octet  unsigned 8-bit integer   type of first fixed surface (see Code Table 4.5) lv1l type
 1 octet  8-bit signed integer     scale factor of first fixed surface              lvl1 scale_factor
 4 octets 32-bit signed integer    scaled value of first fixed surface              lvl1 scaled_value
                            
 1 octet  unsigned 8-bit integer   type of 2nd fixed surface (see Code Table 4.5)   lvl2 type
 1 octet  8-bit signed integer     scale factor of 2nd surface                      lvl2 scale_factor
 4 octets 32-bit signed integer    scaled value of 2nd fixed surface                lvl2 scaled_value

 value = scaled_value * 10**(-scale_factor)
 Note: missing is denoted by scale factor and scale value having all bits set to one

lvl format   value is not missing
             lvl1=(type,scaled_value*10**(-scale_factor), scale_factor, scaled_value)
             lvl2=(type,scaled_value*10**(-scale_factor), scale_factor, scaled_value)

lvl format   value is missing
             lvl1=(type,missing,missing,missing)
             lvl2=(type,missing,missing,missing)

	     type = 0..255
</pre>


<h3>Usage</h3>
<p>

<pre>
-set_lvl1 (type,X,Y,Z)
	   type=0..255  <a href='https://www.nco.ncep.noaa.gov/pmb/docs/grib2/grib2_doc/grib2_table4-5.shtml'>Code Table 4.5</a>
	   X=missing if missing values
	     value ignored if not missing
           Y=scaled value, ignored if X is 'missing'
	   Z=integer, ignored if X is 'missing'
-set_lvl2  same as -set_lvl1
</pre>


<h3>Example</h3>
<pre>
$ <font color=brown>wgrib2 small.grb2 -s -lvl</font>
[wd51we@cpc-lw-webisuzaki grib2_examples]$ wgrib2 small.grb2 -s -lvl
1:0:d=2009060500:HGT:200 mb:180 hour fcst:ENS=+19:lvl1=(100,20000,0,20000):lvl2=(255,missing,missing,missing)
$ <font color=brown>wgrib2 small.grb2 -set_lvl1 "(100,0,0,12345)" -s -lvl</font>
1:0:d=2009060500:HGT:123.45 mb:180 hour fcst:ENS=+19:lvl1=(100,12345,0,12345):lvl2=(255,missing,missing,missing)
</pre>



See also: <a href="./lvl1.html">-lvl1</a>,
<a href="./lev.html">-lev</a>,

</td>
</tr>


<!--  End of Content area  -->
<!--   ...............................................Footer Portion.........................................    -->
 <tr>
  <td>
   <table width="500">
    <tr>
     <td colSpan="3"><hr></td>
    </tr>
    <TR vAlign="top">
     <TD class="gray">
      <A href="https://www.noaa.gov/" class="homepagelinks"><SPAN class="gray">NOAA/</SPAN></A>
      <A href="https://www.nws.noaa.gov/" class="homepagelinks"><SPAN class="gray">National Weather Service</SPAN></A><BR>
      <A href="https://www.ncep.noaa.gov/" class="homepagelinks"><SPAN class="gray">National Centers for Environmental Prediction</SPAN></a><BR>
        Climate Prediction Center<BR>
        5830 University Research Court<BR>
        College Park, Maryland 20740<BR>
      <A href="/comment-form.html" class="homepagelinks"><SPAN class="gray">Climate Prediction Center Web Team</SPAN></A><BR>
        Page 11/2023
     </TD>
     <TD>
      <A href="https://weather.gov/disclaimer.php" class="homepagelinks"><SPAN class="gray">Disclaimer</SPAN></A>
     </TD>
     <TD align="right">
      <A href="https://weather.gov/privacy.php" class="homepagelinks"> <SPAN class="gray">Privacy Policy</SPAN></A>
     </TD>
    </TR>
   </table>
  </td>
 </tr>
</table>
</td>
</tr>
</table>
</body>
</html>


<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
  <title>Climate Prediction Center - wgrib2: special files</title>
  <meta http-equiv=Content-Type content="text/html; charset=windows-1252">
  <meta content="NCEP Web Team" name="GENERATOR">
  <meta name="keywords"
  content="Climate,Climate Prediction Center,National Weather Service,National Oceanic &amp; Atmospheric Administration, NOAA,El Nino,La Nina,ENSO,climate outlooks,El Nino Advisory,La Nina Advisory,droughts,hurricanes,Threats Assessment,Drought Assessment,Drought Monitor,CLimate Diagnostics Bulletin,6-10 day outlook,8-14 day outlook, 6-10 day forecast,8-14 day forecast,MRF,UV Index,North Atlantic Oscillation,NAO,Pacific Decadal Oscillation,PDO,sea surface temperatures,SST,Palmer Drought Severity Index, African Desk,outlooks,expert assessments,monitoring,advisories,stratosphere,temperature,precipitation,snow cover,snowfall,soil moisture,OLR,ozone,degree days,CLIMATE,CLIMATE PREDICTION CENTER,EL NINO,LA NINA, CLIMATE OUTLOOKS,HURRICANES,ASSESSMENTS,SNOW,STRATOSPHERE,DROUGHT,OZONE,DEGREE DAYS">
  <link href="/nwscwi/main.css" type="text/css" rel="STYLESHEET">
</head>
<body leftmargin="0" background="/nwscwi/background.gif" 
      topmargin="0" rightmargin="0" marginheight="0" marginwidth="0">
<table cellspacing="0" cellpadding="0" width="100%" background="/nwscwi/topbanner.jpg" border="0">
  <tr>
    <td align="right" height="19">
      <a href="#contents"><img height="1" alt="Skip Navigation Links"
         src="/nwscwi/skipgraphic.gif" width="1" border="0"></a>
      <a href="https://www.nws.noaa.gov/" class="homepagelinks"><span class="nwslink">www.nws.noaa.gov</span></a>&nbsp;</td>
  </tr>
</table>
<table cellspacing="0" cellpadding="0" width="100%" border="0">
  <tr>
    <td rowspan="2"><a href="https://www.noaa.gov/">
      <img height="78" alt="NOAA logo - Click to go to the NOAA home page"
      src="/nwscwi/noaaleft.jpg" width="85" border="0"></a></td>
    <td align="left"><img height="20" alt="National Weather Service"
      src="/nwscwi/nws_title.jpg" width="500" border="0"></td>
    <td rowspan="2" width="100%" background="/nwscwi/ncep_bkgrnd.jpg">&nbsp;</td>
    <td rowspan="2" align="right"><a href="https://www.nws.noaa.gov/">
      <img height="78" alt="NWS logo - Click to go to the NWS home page"
      src="/nwscwi/nwsright.jpg" width="85" border="0"></a></td>
  </tr>
  <tr>
    <td><img height="58" alt="Climate Prediction Center" src="/nwscwi/cpc.jpg"
             width="500" border="0"></td>    <!-- Put your center header image here. -->
  </tr>
</table>
<table cellspacing="0" cellpadding="0" width="100%" background="/nwscwi/navbkgrnd.gif" border="0">
  <tr>
    <td align="left" valign="top" width="94"><img height="23" alt="" src="/nwscwi/navbarleft.jpg" width
="94" border="0"></td>
    <td class="nav" align="center" width="15%">
      <a href="/products/site_index.html" class="menu">Site Map</a></td> <!-- Build a text only sitemap, and link to it via this
                                                    sitemap button just below the banner.
                                                    The sitemap should include a heirarchy of links
                                                    from NOAA, to the NWS, to NCEP, and then through your site. -->
    <td class="nav" align="right" width="15%">
      <a href="https://www.nws.noaa.gov/pa/" class="menu">News</a></td>
    <td class="nav" id="menuitem" align="right" width="20%">
      <a href="https://weather.gov/organization.php" class="menu">Organization</a></td>
    <td class="yellow" align="right" width="20%">
      <form action="https://www.firstgov.gov/fgsearch/index.jsp" name="query">
        <label for="search">Search</label>&nbsp;</td>
    <td align="left" class="searchinput" width="20%" nowrap>
      <input type="hidden" name="parsed" value="true">
      <input type="hidden" name="rn" value="3">
      <input type="hidden" name="in0" value="domain">
      <input type="hidden" name="dom0" value="nws.noaa.gov, weather.gov, wrh.noaa.gov, srh.noaa.gov, crh.noaa.gov, prh.noaa.gov, arh.noaa.gov, alaska.net/~nwsar, erh.noaa.gov, ncep.noaa.gov, wwb.noaa.gov, spc.noaa.gov, nhc.noaa.gov, sec.noaa.gov, aviationweather.gov, aviationweather.noaa.gov, weather.noaa.gov, roc.noaa.gov, nohrsc.nws.gov, nwstc.noaa.gov, wdtb.noaa.gov, npmoc.navy.mil, ndbc.noaa.gov">
      <input type="text" name="mw0" value="All NWS Search" id="search" size="20" maxlength="256">
      <input type="submit" name="Go2" value="Go"></td>
    <td width="10%">&nbsp;</form></td>
    <td align="right" valign="bottom" width="24"><img height="23" alt="" src="/nwscwi/navbarendcap.jpg"
 width="24" border="0"></td>
  </tr>
</table>
<table cellspacing="0" cellpadding="0" width="670" border="0">
  <tr valign="top">
    <td width="137"><br>
      <table cellspacing="0" cellpadding="2" width="137" border="0">
        <!-- Do not remove this section. You will need this when the City,St/zip search is implemented nationwide.-->
        <!-- <tr align="left" valign="top">
                <td class="searchinput">
                  <div id="Layer2" style="position:absolute; width:200px; height:115px; z-index:2; visibility: hidden">Search by city or zip code. Press enter or select the go button to submit request</div>
                  <form method="POST" action="https://www.srh.noaa.gov/zipcity.php">
                  <span class="yellow">Local forecast by<br>&quot;City, St&quot; or Zip Code</span><br>
                  <input type="text" name="inputstring" size="9" value="City, St">
                  <input type="submit" name="Go2" value="Go"></form></td>
        </tr> -->
         <tr>
          <td class="searchinput" align="left">
            <form action="https://www.firstgov.gov/fgsearch/index.jsp" name="query">
             <label for="search"><span class="yellow">CPC Search</span></label>
              <input type="hidden" name="parsed" value="true">
              <input type="hidden" name="rn" value="3">
              <input type="hidden" name="in0" value="domain">
              <input type="hidden" name="dom0" value="www.cpc.ncep.noaa.gov">
              <input type="text" name="mw0" id="search"  size="10" maxLength="256" value="CPC search">&nbsp;
              <input type="submit" name="Go2" value="Go">
          </form></td>
         </tr>
        <tr>
          <td class="white">
            <span class="yellow">About Us</span><br>
            &nbsp;&nbsp;&nbsp;<a href="/information/who_we_are/mission.html" class="menu">Our Mission</a><br>
            &nbsp;&nbsp;&nbsp;<a href="/information/who_we_are/" class="menu">Who We Are</a><br><br>
            <span class="yellow">Contact Us</span><br>
            &nbsp;&nbsp;&nbsp;<a href="/information/personnel/contacts.html" class="menu">CPC Information</a><br>
            &nbsp;&nbsp;&nbsp;<a href="/comment-form.html" class="menu">CPC Web Team</a><br><br>           
          </td>
        </tr>
      </table>
    </td>
    <td valign="top" align="center" width="533"><a name="contents"></a>

<!-- Begin content area -->

<table border="0" cellPadding="2" cellSpacing="0" align="center" width="533">
 <tr><td>&nbsp;</td></tr>
 <tr>
  <td>
   <font face="Verdana,arial,serif" size="1"><a href="/index.html" class="homepagelinks"><strong>HOME</strong></a> &gt; <a href="/products/monitoring_and_data" class="homepagelinks">Monitoring_and_Data</a> &gt; <a href="/products/monitoring_and_data/oadata.html" class="homepagelinks">Oceanic and Atmospheric Data</a> &gt; <a href="/products/wesley/" class="homepagelinks">Reanalysis: Atmospheric Data</a> &gt; wgrib2 special files</font>
  </td>
 </tr>
 <tr><td>&nbsp;</td></tr>
 <tr>
  <td>
<font color=red>
<h3 align=center>wgrib2: special files</h3>
</font>


<h3>Introduction: Special Files</h3>

<p>Wgrib2 has some special files. They are

<ol>
<li> -  (negative sign)
<li> @tmp:STRING   where STRING is a alphanumeric string
<li> @mem:N  N=0..19
<li> Unix/Linux: /dev/null
</ol>

<h3> 1. - (negative sign)</h3>

This special file name is often used by unix/linux utilities to denote either
stdin or stdout.  The context will determine whether stdin or stdout is used.
This special file name is often used to pipe data between processes.

<pre>
Example:  wgrib2 IN.grb -set_grid_winds earth -set_grid ncep grid 3  - | \
            wgrib2 - -ncep_uv OUT.grb

          The first wgrib2 regrids the file to ncep grid #3 and uses -
            to send the output to stdout.
          The second wgrib2 combines U and V into the same grib message.
            In this case, the - indicates that the input file is stdin.
          This form is fast because both processes run in parallel and
          there is no temporary disk file.
 </pre>

<h3> 2. @tmp:STRING (temporary files)</h3>

This special file name is used for creating temporary files which will disappear
after the process is finished. Multiple wgrib2 processes can use the same
@tmp:STRING file without conflict.  These files are only useful with callable wgrib2.

<pre>
Example:
!  make a temporary inventory file
  i = wgrib2('ds.td.bin', '-inv', '@tmp:abc.inv')
! inquire how many grid point the "150 hour fcst" has
  i = grb2_inq('ds.td.bin', '@tmp:abc.inv', ':150 hour fcst:',npts=j)
  write(*,*) 'error code=',i,' number of grid points=',j
</pre>

<h3> 3. @mem:N (memory files) (alpha)</h3>

<p> @mem:N where N=0..9 are memory files which are stored in 
computer's random-access memory.  Memory files are fast but
are limited by the size of the computer's memory.
Memory files can be used
almost everywhere that files can be used (see below for exceptions). 
Memory files are transient; whenever the wgrib2 ends, the memory files
are lost. Memory files can be read/written to disk files prior/after
processing by using the options -mem_init and -mem_final.  
For callable wgrib2, the memory files are lost when the calling program finishes.


<p> Memory files were implimented so that callable wgrib2 could be
used for HPC.  For example, decoding can be done by calling a routine puts a 
grib message into a memory file.  The wgrib2 subroutine can then
process the memory file and writes the decoded field to either a
memory file or a RPN register.
Finally the program can call another routine
that reads the memory file or RPN register.

<p> Memory files are often used by CW2 to store grib inventories.
They are also used internally by grep Fortran API (memory file 19).

<p>
Memory files can be used to speed up processing.  Suppose you
are going to re-order a grib file. Without memory files, you
would create an inventory (sequential read), sort the inventory,
and do a random-access read and a sequential write.  With memory
files, you could copy the grib file into memory and then
avoid the slow random-access read.

<pre>
wgrib2 IN.grb | sort -t: -k3.3 -k4,4 -k5,5 | \
   wgrib2 -i IN.grb -grib sorted.grb

wgrib2 IN.grb | sort -t: -k3.3 -k4,4 -k5,5 | \
   wgrib2 -i -mem_init 0 IN.grb @mem:0 -grib sorted.grb
</pre>


<h3> 4. /dev/null</h3>

Don't ask your Linux system admin to recover data sent to /dev/null.

<h3> Options that don't support memory files</h3>

<ol>
<li> -AAIG
<li> -csv
<li> -err_bin
<li> -err_bin
<li> -grib_ieee
<li> -grid_out
<li> -ijbox
<li> -import_text
<li> -spread
<li> -text
</ol>

<h3>Generic Behavior:</h3>

<p> When a file is opened by wgrib2, both the file handle and file name
are saved. This allows wgrib2 supports multiple opens to the same file.  For example,

<pre>
  wgrib2 IN.grb -if ":HGT:" -grib OUT.grb \
                -if ":TMP:" -grib OUT.grb \
                -if ":UGRD:" -grib OUT.grb \
                -if ":VGRD:" -grib OUT.grb
</pre>

writes the HGT, TMP, UGRD and VGRD to OUT.grb as you would expect.  Technically
the 4 -grib options use the same file handle.  Now if you change the above command
so that the last -grib writes to ./OUT.grb instead of OUT.grb. 

<pre>
  wgrib2 IN.grb -if ":HGT:" -grib OUT.grb \
                -if ":TMP:" -grib OUT.grb \
                -if ":UGRD:" -grib OUT.grb \
                -if ":VGRD:" -grib ./OUT.grb
</pre>
You and I know that all 4 -grib options refer to the same file.  However, wgrib2 
only does a string check and uses two file handles to refer to the same file.
Confusion occurs and the resultant OUT.grb will be corrupted. Therefore,
you must use consistent naming when referring to the same file.

<h3>Persistance:</h3>

By default, wgrib2 saves the file name and file handle for opened files.
This can be handy with callable wgrib2.  You can save the time required
for multiple opens of the same file.  However, this persistence of the
file name and file handle can require some care.  Operating systems
can have a limit on the number of open files, so you may have to close files that
are no longer needed.  For some operations, you may want to 
rewind a file.


<p>
See also: 
</td>
</tr>


<!--  End of Content area  -->
<!--   ...............................................Footer Portion.........................................    -->
 <tr>
  <td>
   <table width="500">
    <tr>
     <td colSpan="3"><hr></td>
    </tr>
    <TR vAlign="top">
     <TD class="gray">
      <A href="https://www.noaa.gov/" class="homepagelinks"><SPAN class="gray">NOAA/</SPAN></A>
      <A href="https://www.nws.noaa.gov/" class="homepagelinks"><SPAN class="gray">National Weather Service</SPAN></A><BR>
      <A href="https://www.ncep.noaa.gov/" class="homepagelinks"><SPAN class="gray">National Centers for Environmental Prediction</SPAN></a><BR>
        Climate Prediction Center<BR>
        5830 University Research Court<BR>
        College Park, Maryland 20740<BR>
      <A href="/comment-form.html" class="homepagelinks"><SPAN class="gray">Climate Prediction Center Web Team</SPAN></A><BR>
        Page last modified: Aug 2, 2016
     </TD>
     <TD>
      <A href="https://weather.gov/disclaimer.php" class="homepagelinks"><SPAN class="gray">Disclaimer</SPAN></A>
     </TD>
     <TD align="right">
      <A href="https://weather.gov/privacy.php" class="homepagelinks"> <SPAN class="gray">Privacy Policy</SPAN></A>
     </TD>
    </TR>
   </table>
  </td>
 </tr>
</table>
</td>
</tr>
</table>
</body>
</html>


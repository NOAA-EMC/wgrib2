<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
  <title>Climate Prediction Center - wgrib2: -grid_def</title>
  <meta http-equiv=Content-Type content="text/html; charset=windows-1252">
  <meta content="NCEP Web Team" name="GENERATOR">
  <meta name="keywords"
  content="Climate,Climate Prediction Center,National Weather Service,National Oceanic &amp; Atmospheric Administration, NOAA,El Nino,La Nina,ENSO,climate outlooks,El Nino Advisory,La Nina Advisory,droughts,hurricanes,Threats Assessment,Drought Assessment,Drought Monitor,CLimate Diagnostics Bulletin,6-10 day outlook,8-14 day outlook, 6-10 day forecast,8-14 day forecast,MRF,UV Index,North Atlantic Oscillation,NAO,Pacific Decadal Oscillation,PDO,sea surface temperatures,SST,Palmer Drought Severity Index, African Desk,outlooks,expert assessments,monitoring,advisories,stratosphere,temperature,precipitation,snow cover,snowfall,soil moisture,OLR,ozone,degree days,CLIMATE,CLIMATE PREDICTION CENTER,EL NINO,LA NINA, CLIMATE OUTLOOKS,HURRICANES,ASSESSMENTS,SNOW,STRATOSPHERE,DROUGHT,OZONE,DEGREE DAYS">
  <link href="/nwscwi/main.css" type="text/css" rel="STYLESHEET">
</head>
<body leftmargin="0" background="/nwscwi/background.gif" 
      topmargin="0" rightmargin="0" marginheight="0" marginwidth="0">
<table cellspacing="0" cellpadding="0" width="100%" background="/nwscwi/topbanner.jpg" border="0">
  <tr>
    <td align="right" height="19">
      <a href="#contents"><img height="1" alt="Skip Navigation Links"
         src="/nwscwi/skipgraphic.gif" width="1" border="0"></a>
      <a href="https://www.nws.noaa.gov/" class="homepagelinks"><span class="nwslink">www.nws.noaa.gov</span></a>&nbsp;</td>
  </tr>
</table>
<table cellspacing="0" cellpadding="0" width="100%" border="0">
  <tr>
    <td rowspan="2"><a href="https://www.noaa.gov/">
      <img height="78" alt="NOAA logo - Click to go to the NOAA home page"
      src="/nwscwi/noaaleft.jpg" width="85" border="0"></a></td>
    <td align="left"><img height="20" alt="National Weather Service"
      src="/nwscwi/nws_title.jpg" width="500" border="0"></td>
    <td rowspan="2" width="100%" background="/nwscwi/ncep_bkgrnd.jpg">&nbsp;</td>
    <td rowspan="2" align="right"><a href="https://www.nws.noaa.gov/">
      <img height="78" alt="NWS logo - Click to go to the NWS home page"
      src="/nwscwi/nwsright.jpg" width="85" border="0"></a></td>
  </tr>
  <tr>
    <td><img height="58" alt="Climate Prediction Center" src="/nwscwi/cpc.jpg"
             width="500" border="0"></td>    <!-- Put your center header image here. -->
  </tr>
</table>
<table cellspacing="0" cellpadding="0" width="100%" background="/nwscwi/navbkgrnd.gif" border="0">
  <tr>
    <td align="left" valign="top" width="94"><img height="23" alt="" src="/nwscwi/navbarleft.jpg" width
="94" border="0"></td>
    <td class="nav" align="center" width="15%">
      <a href="/products/site_index.html" class="menu">Site Map</a></td> <!-- Build a text only sitemap, and link to it via this
                                                    sitemap button just below the banner.
                                                    The sitemap should include a heirarchy of links
                                                    from NOAA, to the NWS, to NCEP, and then through your site. -->
    <td class="nav" align="right" width="15%">
      <a href="https://www.nws.noaa.gov/pa/" class="menu">News</a></td>
    <td class="nav" id="menuitem" align="right" width="20%">
      <a href="https://weather.gov/organization.php" class="menu">Organization</a></td>
    <td class="yellow" align="right" width="20%">
      <form action="https://www.firstgov.gov/fgsearch/index.jsp" name="query">
        <label for="search">Search</label>&nbsp;</td>
    <td align="left" class="searchinput" width="20%" nowrap>
      <input type="hidden" name="parsed" value="true">
      <input type="hidden" name="rn" value="3">
      <input type="hidden" name="in0" value="domain">
      <input type="hidden" name="dom0" value="nws.noaa.gov, weather.gov, wrh.noaa.gov, srh.noaa.gov, crh.noaa.gov, prh.noaa.gov, arh.noaa.gov, alaska.net/~nwsar, erh.noaa.gov, ncep.noaa.gov, wwb.noaa.gov, spc.noaa.gov, nhc.noaa.gov, sec.noaa.gov, aviationweather.gov, aviationweather.noaa.gov, weather.noaa.gov, roc.noaa.gov, nohrsc.nws.gov, nwstc.noaa.gov, wdtb.noaa.gov, npmoc.navy.mil, ndbc.noaa.gov">
      <input type="text" name="mw0" value="All NWS Search" id="search" size="20" maxlength="256">
      <input type="submit" name="Go2" value="Go"></td>
    <td width="10%">&nbsp;</form></td>
    <td align="right" valign="bottom" width="24"><img height="23" alt="" src="/nwscwi/navbarendcap.jpg"
 width="24" border="0"></td>
  </tr>
</table>
<table cellspacing="0" cellpadding="0" width="670" border="0">
  <tr valign="top">
    <td width="137"><br>
      <table cellspacing="0" cellpadding="2" width="137" border="0">
        <!-- Do not remove this section. You will need this when the City,St/zip search is implemented nationwide.-->
        <!-- <tr align="left" valign="top">
                <td class="searchinput">
                  <div id="Layer2" style="position:absolute; width:200px; height:115px; z-index:2; visibility: hidden">Search by city or zip code. Press enter or select the go button to submit request</div>
                  <form method="POST" action="https://www.srh.noaa.gov/zipcity.php">
                  <span class="yellow">Local forecast by<br>&quot;City, St&quot; or Zip Code</span><br>
                  <input type="text" name="inputstring" size="9" value="City, St">
                  <input type="submit" name="Go2" value="Go"></form></td>
        </tr> -->
         <tr>
          <td class="searchinput" align="left">
            <form action="https://www.firstgov.gov/fgsearch/index.jsp" name="query">
             <label for="search"><span class="yellow">CPC Search</span></label>
              <input type="hidden" name="parsed" value="true">
              <input type="hidden" name="rn" value="3">
              <input type="hidden" name="in0" value="domain">
              <input type="hidden" name="dom0" value="www.cpc.ncep.noaa.gov">
              <input type="text" name="mw0" id="search"  size="10" maxLength="256" value="CPC search">&nbsp;
              <input type="submit" name="Go2" value="Go">
          </form></td>
         </tr>
        <tr>
          <td class="white">
            <span class="yellow">About Us</span><br>
            &nbsp;&nbsp;&nbsp;<a href="/information/who_we_are/mission.html" class="menu">Our Mission</a><br>
            &nbsp;&nbsp;&nbsp;<a href="/information/who_we_are/" class="menu">Who We Are</a><br><br>
            <span class="yellow">Contact Us</span><br>
            &nbsp;&nbsp;&nbsp;<a href="/information/personnel/contacts.html" class="menu">CPC Information</a><br>
            &nbsp;&nbsp;&nbsp;<a href="/comment-form.html" class="menu">CPC Web Team</a><br><br>           
          </td>
        </tr>
      </table>
    </td>
    <td valign="top" align="center" width="533"><a name="contents"></a>

<!-- Begin content area -->

<table border="0" cellPadding="2" cellSpacing="0" align="center" width="533">
 <tr><td>&nbsp;</td></tr>
 <tr>
  <td>
   <font face="Verdana,arial,serif" size="1"><a href="/index.html" class="homepagelinks"><strong>HOME</strong></a> &gt; <a href="/products/monitoring_and_data" class="homepagelinks">Monitoring_and_Data</a> &gt; <a href="/products/monitoring_and_data/oadata.html" class="homepagelinks">Oceanic and Atmospheric Data</a> &gt; <a href="/products/wesley/" class="homepagelinks">Reanalysis: Atmospheric Data</a> &gt; wgrib2-grid_def</font>
  </td>
 </tr>
 <tr><td>&nbsp;</td></tr>
 <tr>
  <td>
<font color=red>
<h3 align=center>wgrib2: -grid_def</h3>
</font>


<h3>Introduction</h3>

<p> When wgrib2 processes a field, it often calculates the longitude
and latitude (location) of each grid point.  Wgrib2 doesn't do the calculation
when one of the following conditions are true
<ol>
<li> the locations of the grid points are not needed by any of the options
<li> the grid is the same as the previously processed grib message
<li> wgrib2 does not know how to calculate the locations
</ol>

<p>
For some grids, wgrib2 does not know how to calculate the grid locations
and the grid locations are available from the center in the form of grib files.
Then you can use the <font color=red>-grid_def</font> to add the grid
locations for wgrib2 processing.  
The option, <font color=red>-grid_def</font> checks to see if the grib message
is a longitude or latitude.  If it is, the longitude or latitude is associated
with the longitude or latitude of the grid points.
Because of "2", wgrib2 will use these longitudes
or latitudes for the following fields until wgrib2 encountours a different
grid.


<h3>wgrib2 up to v2.0.5</h3>
<p> Bug in the <font color=red>-grid_def</font> option only allows
the option to work with grids with calculated grid locations.
(Passed testing but not that useful.)

<h3>wgrib2 v2.0.6, v2.0.7</h3>

<ol>
<li> LOUV, LOPP or ELON will associate the data with the longitudes
<li> LAUV, LAPP or NLAT will associate the data with the latitudes
</ol>

<h3>wgrib2 v2.0.8+</h3>
<ol>
<li> LOUV, LOPP, ELON or GEOLON will associate the data with the longitudes
<li> LAUV, LAPP, NLAT or GEOLAT will associate the data with the latitudes
</ol>


<h3>wgrib2 v3.0.0+</h3>
With wgrib2 v3.0.0 can associated latitudes and longitudes using -rpn
and the "sto_lat" and "sto_lon" options.  You can import double precision
lat and lons using -import_lonlat.

<h3>Precision of the latitudes and longitudes</h3>
By default, grib2 stores angles to the millionth of a degree.  This
requires the angles to be stored in double precision.  Reading the
latitudes and longitudes in grib format could be done in double
precision but the current decoder is limited to 25 bits which is
basically single precision.  If you need double precision lat and lon
values, use -import_lonlat.

<p>
<h3>Usage</h3>
<pre>
-grib_def
  will alter the latitude or longitudes associated with the grid points
  when the variable is a latitude or longitude field
</p>

<h3>Example</h3>

For <font color=red>-grid_def</font> to work, the latitude and longitudes have
processed prior the to remaining grids.  The file, icon.grb, satifies this requirement.

<pre>
$ <font color=brown>wgrib2 icon.grb </font>
1:0:d=2019040900:GEOLON:surface:anl:
2:5898409:d=2019040900:GEOLAT:surface:anl:
3:11796818:d=2019040900:TMP:2 m above ground:0-360 min max fcst:
</pre>

An additional requirement is the grids be the same.
<pre>
$ <font color=brown>wgrib2 icon.grb -grid</font>
1:0:grid_template=101:
	General Unstructured Grid grid=26 ref_grid=1 uuid=a27b8de6-18c4-11e4-820a-b5b098c6a5c0

2:5898409:grid_template=101:
	General Unstructured Grid grid=26 ref_grid=1 uuid=a27b8de6-18c4-11e4-820a-b5b098c6a5c0

3:11796818:grid_template=101:
	General Unstructured Grid grid=26 ref_grid=1 uuid=a27b8de6-18c4-11e4-820a-b5b098c6a5c0
</pre>
<p>
A more precise method of identifying identical grids is by

<pre>
$ <font color=brown>wgrib2 icon.grb -checksum 3</font>     (Section 3 is the grid defininition template)
1:0:sec3_cksum=470959557
2:5898409:sec3_cksum=470959557
3:11796818:sec3_cksum=470959557
</pre>

Using wgrib2 v3.0.0+, we can get a 2x2 degree lat-lon grid by,

<pre>
$ <font color=brown>wgrib2 icon.grb -grid_def -not_if ":GEO(LAT|LON):" -s -lola 0:180:2 -90:91:2 lola.grb grib -endif</font>
1:0
2:5898409
3:11796818:d=2019040900:TMP:2 m above ground:0-6 hour max fcst:
bash-4.1$ wgrib2 lola.grb -s -grid
1:0:d=2019040900:TMP:2 m above ground:0-360 min max fcst::grid_template=0:winds(N/S):
	lat-lon grid:(180 x 91) units 1e-06 input WE:SN output WE:SN res 48
	lat -90.000000 to 90.000000 by 2.000000
	lon 0.000000 to 358.000000 by 2.000000 #points=16380

The -not_if is used so that GEOLAT and GEOLON fields are not interpolated.
</pre>

For wgrib2 up to v2.0.6 and, -grid_def did not recognize GEOLAT and GEOLON.
As a result, the location had to be converted to NLAT and ELON which are
recognized.  NLAT and ELON are NCEP local variables, so the center has to
be changed to 7 which is NCEP by the GRIB standard.

<pre>
$ <font color=brown>wgrib2 icon.grb \
  -if ":GEOLAT:" -set center 7 -set_var NLAT -fi \
  -if ":GEOLON:" -set center 7 -set_var ELON -fi \
  -grid_def -s \
  -not_if ":GEO(LAT|LON):" -s -lola '0:180:2' '-90:91:2' lola.grb grib</font>
1:0:d=2019040900:ELON:local level type 1 0:anl:
2:5898409:d=2019040900:NLAT:local level type 1 0:anl:
3:11796818:d=2019040900:TMP:local level type 103 2:0-6 hour max fcst::d=2019040900:TMP:local level type 103 2:0-6 hour max fcst:
</pre>
<p> With wgrib2 v3.0.0, you can also use <font color=red>-rpn</font> to update the latitude and
longitudes.  

<pre>
$ <font color=brown>wgrib2 icon.grb icon.grb -if ":GEOLAT:" -rpn sto_lat -endif -if ":GEOLON:" -rpn sto_lon -endif \
  -not_if ":GEO(LAT|LON):" -s -lola "0:180:2" "-90:91:2" lola.grb grib -endif</font>
<pre>

See also: 
<a href="./rpn.html">-rpn</a>

</td>
</tr>


<!--  End of Content area  -->
<!--   ...............................................Footer Portion.........................................    -->
 <tr>
  <td>
   <table width="500">
    <tr>
     <td colSpan="3"><hr></td>
    </tr>
    <TR vAlign="top">
     <TD class="gray">
      <A href="https://www.noaa.gov/" class="homepagelinks"><SPAN class="gray">NOAA/</SPAN></A>
      <A href="https://www.nws.noaa.gov/" class="homepagelinks"><SPAN class="gray">National Weather Service</SPAN></A><BR>
      <A href="https://www.ncep.noaa.gov/" class="homepagelinks"><SPAN class="gray">National Centers for Environmental Prediction</SPAN></a><BR>
        Climate Prediction Center<BR>
        5830 University Research Court<BR>
        College Park, Maryland 20740<BR>
      <A href="/comment-form.html" class="homepagelinks"><SPAN class="gray">Climate Prediction Center Web Team</SPAN></A><BR>
        Page last modified: April 10, 2019
     </TD>
     <TD>
      <A href="https://weather.gov/disclaimer.php" class="homepagelinks"><SPAN class="gray">Disclaimer</SPAN></A>
     </TD>
     <TD align="right">
      <A href="https://weather.gov/privacy.php" class="homepagelinks"> <SPAN class="gray">Privacy Policy</SPAN></A>
     </TD>
    </TR>
   </table>
  </td>
 </tr>
</table>
</td>
</tr>
</table>
</body>
</html>


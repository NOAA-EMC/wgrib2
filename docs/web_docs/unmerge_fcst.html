<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
  <title>Climate Prediction Center - wgrib2: -unmerge_fcst</title>
  <meta http-equiv=Content-Type content="text/html; charset=windows-1252">
  <meta content="NCEP Web Team" name="GENERATOR">
  <meta name="keywords"
  content="Climate,Climate Prediction Center,National Weather Service,National Oceanic &amp; Atmospheric Administration, NOAA,El Nino,La Nina,ENSO,climate outlooks,El Nino Advisory,La Nina Advisory,droughts,hurricanes,Threats Assessment,Drought Assessment,Drought Monitor,CLimate Diagnostics Bulletin,6-10 day outlook,8-14 day outlook, 6-10 day forecast,8-14 day forecast,MRF,UV Index,North Atlantic Oscillation,NAO,Pacific Decadal Oscillation,PDO,sea surface temperatures,SST,Palmer Drought Severity Index, African Desk,outlooks,expert assessments,monitoring,advisories,stratosphere,temperature,precipitation,snow cover,snowfall,soil moisture,OLR,ozone,degree days,CLIMATE,CLIMATE PREDICTION CENTER,EL NINO,LA NINA, CLIMATE OUTLOOKS,HURRICANES,ASSESSMENTS,SNOW,STRATOSPHERE,DROUGHT,OZONE,DEGREE DAYS">
  <link href="/nwscwi/main.css" type="text/css" rel="STYLESHEET">
</head>
<body leftmargin="0" background="/nwscwi/background.gif" 
      topmargin="0" rightmargin="0" marginheight="0" marginwidth="0">
<table cellspacing="0" cellpadding="0" width="100%" background="/nwscwi/topbanner.jpg" border="0">
  <tr>
    <td align="right" height="19">
      <a href="#contents"><img height="1" alt="Skip Navigation Links"
         src="/nwscwi/skipgraphic.gif" width="1" border="0"></a>
      <a href="https://www.nws.noaa.gov/" class="homepagelinks"><span class="nwslink">www.nws.noaa.gov</span></a>&nbsp;</td>
  </tr>
</table>
<table cellspacing="0" cellpadding="0" width="100%" border="0">
  <tr>
    <td rowspan="2"><a href="https://www.noaa.gov/">
      <img height="78" alt="NOAA logo - Click to go to the NOAA home page"
      src="/nwscwi/noaaleft.jpg" width="85" border="0"></a></td>
    <td align="left"><img height="20" alt="National Weather Service"
      src="/nwscwi/nws_title.jpg" width="500" border="0"></td>
    <td rowspan="2" width="100%" background="/nwscwi/ncep_bkgrnd.jpg">&nbsp;</td>
    <td rowspan="2" align="right"><a href="https://www.nws.noaa.gov/">
      <img height="78" alt="NWS logo - Click to go to the NWS home page"
      src="/nwscwi/nwsright.jpg" width="85" border="0"></a></td>
  </tr>
  <tr>
    <td><img height="58" alt="Climate Prediction Center" src="/nwscwi/cpc.jpg"
             width="500" border="0"></td>    <!-- Put your center header image here. -->
  </tr>
</table>
<table cellspacing="0" cellpadding="0" width="100%" background="/nwscwi/navbkgrnd.gif" border="0">
  <tr>
    <td align="left" valign="top" width="94"><img height="23" alt="" src="/nwscwi/navbarleft.jpg" width
="94" border="0"></td>
    <td class="nav" align="center" width="15%">
      <a href="/products/site_index.html" class="menu">Site Map</a></td> <!-- Build a text only sitemap, and link to it via this
                                                    sitemap button just below the banner.
                                                    The sitemap should include a heirarchy of links
                                                    from NOAA, to the NWS, to NCEP, and then through your site. -->
    <td class="nav" align="right" width="15%">
      <a href="https://www.nws.noaa.gov/pa/" class="menu">News</a></td>
    <td class="nav" id="menuitem" align="right" width="20%">
      <a href="https://weather.gov/organization.php" class="menu">Organization</a></td>
    <td class="yellow" align="right" width="20%">
      <form action="https://www.firstgov.gov/fgsearch/index.jsp" name="query">
        <label for="search">Search</label>&nbsp;</td>
    <td align="left" class="searchinput" width="20%" nowrap>
      <input type="hidden" name="parsed" value="true">
      <input type="hidden" name="rn" value="3">
      <input type="hidden" name="in0" value="domain">
      <input type="hidden" name="dom0" value="nws.noaa.gov, weather.gov, wrh.noaa.gov, srh.noaa.gov, crh.noaa.gov, prh.noaa.gov, arh.noaa.gov, alaska.net/~nwsar, erh.noaa.gov, ncep.noaa.gov, wwb.noaa.gov, spc.noaa.gov, nhc.noaa.gov, sec.noaa.gov, aviationweather.gov, aviationweather.noaa.gov, weather.noaa.gov, roc.noaa.gov, nohrsc.nws.gov, nwstc.noaa.gov, wdtb.noaa.gov, npmoc.navy.mil, ndbc.noaa.gov">
      <input type="text" name="mw0" value="All NWS Search" id="search" size="20" maxlength="256">
      <input type="submit" name="Go2" value="Go"></td>
    <td width="10%">&nbsp;</form></td>
    <td align="right" valign="bottom" width="24"><img height="23" alt="" src="/nwscwi/navbarendcap.jpg"
 width="24" border="0"></td>
  </tr>
</table>
<table cellspacing="0" cellpadding="0" width="670" border="0">
  <tr valign="top">
    <td width="137"><br>
      <table cellspacing="0" cellpadding="2" width="137" border="0">
        <!-- Do not remove this section. You will need this when the City,St/zip search is implemented nationwide.-->
        <!-- <tr align="left" valign="top">
                <td class="searchinput">
                  <div id="Layer2" style="position:absolute; width:200px; height:115px; z-index:2; visibility: hidden">Search by city or zip code. Press enter or select the go button to submit request</div>
                  <form method="POST" action="https://www.srh.noaa.gov/zipcity.php">
                  <span class="yellow">Local forecast by<br>&quot;City, St&quot; or Zip Code</span><br>
                  <input type="text" name="inputstring" size="9" value="City, St">
                  <input type="submit" name="Go2" value="Go"></form></td>
        </tr> -->
         <tr>
          <td class="searchinput" align="left">
            <form action="https://www.firstgov.gov/fgsearch/index.jsp" name="query">
             <label for="search"><span class="yellow">CPC Search</span></label>
              <input type="hidden" name="parsed" value="true">
              <input type="hidden" name="rn" value="3">
              <input type="hidden" name="in0" value="domain">
              <input type="hidden" name="dom0" value="www.cpc.ncep.noaa.gov">
              <input type="text" name="mw0" id="search"  size="10" maxLength="256" value="CPC search">&nbsp;
              <input type="submit" name="Go2" value="Go">
          </form></td>
         </tr>
        <tr>
          <td class="white">
            <span class="yellow">About Us</span><br>
            &nbsp;&nbsp;&nbsp;<a href="/information/who_we_are/mission.html" class="menu">Our Mission</a><br>
            &nbsp;&nbsp;&nbsp;<a href="/information/who_we_are/" class="menu">Who We Are</a><br><br>
            <span class="yellow">Contact Us</span><br>
            &nbsp;&nbsp;&nbsp;<a href="/information/personnel/contacts.html" class="menu">CPC Information</a><br>
            &nbsp;&nbsp;&nbsp;<a href="/comment-form.html" class="menu">CPC Web Team</a><br><br>           
          </td>
        </tr>
      </table>
    </td>
    <td valign="top" align="center" width="533"><a name="contents"></a>

<!-- Begin content area -->

<table border="0" cellPadding="2" cellSpacing="0" align="center" width="533">
 <tr><td>&nbsp;</td></tr>
 <tr>
  <td>
   <font face="Verdana,arial,serif" size="1"><a href="/index.html" class="homepagelinks"><strong>HOME</strong></a> &gt; <a href="/products/monitoring_and_data" class="homepagelinks">Monitoring_and_Data</a> &gt; <a href="/products/monitoring_and_data/oadata.html" class="homepagelinks">Oceanic and Atmospheric Data</a> &gt; <a href="/products/wesley/" class="homepagelinks">Reanalysis: Atmospheric Data</a> &gt; wgrib2-ncep_norm</font>
  </td>
 </tr>
 <tr><td>&nbsp;</td></tr>
 <tr>
  <td>
<font color=red>
<h3 align=center>wgrib2: -unmerge_fcst (v3.0.0+)</h3>
</font>



<h3>Introduction</h3>
Prior to GFS-FV3, the precipitation was stored in the "old-style".  This style
handled 6 hour accumulations in a simple manner.

<pre>
  0-6, 6-12, 12-18, 18-24, etc
</pre>


Eventually someone wanted to store 3 hour accumulations.  However, people who had code
that read the 6 hour accumulations said that they couldn't change the code.  So the
the file still had to contain the 6 hour accumulations.  So the code to read the
3 hour accumulations had to a subtraction for some of the interval.  They stored
the accumulations like this.


<pre>
  0-3, 0-6, 6-9, 6-12, 12-15, 12-18, 18-21, 18-24, etc
</pre>

Now the FV3-GFS model developers agreed to store precipitation accumulations in
the easy-to-use format,

<pre>
  0-3, 0-6, 0-9, 0-12, 0-15, 0-18, 0-21, 0-24, etc
</pre>

However, people who had code that read the accumulation in the old style said that
they could not change their code.  So they had put old style and new style accumulated
precipitation in the files.

<p>
To process the precip with wgrib2, you want to eliminate the old-style precip.
It is surprisingly difficult because the old style can have to same name as
the new style (ex. 3 hour forecast).  You have to eliminate the old style but
not the new style even though they have the same name.


<p> The <font color=brown>-unmerge_fcst</font> option helps deal with the
FV3-GFS precip problem when trying to make time series.


<h3>Example usage</h3>


<pre>
# make a file with the APCP from cat gfs.t00z.pgrb2.0p25.f(N) N=000..029 
$ cat gfs.t00z.pgrb2.0p25.f00? gfs.t00z.pgrb2.0p25.f01? gfs.t00z.pgrb2.0p25.f02? | wgrib2 - -match APCP -grib $stmp/all_apcpc.grb


# Lets see the new-style precip. in the file
$ cd $stmp
$ wgrib2 all_apcpc.grb -match ':0-'
1:0:d=2020101600:APCP:surface:0-1 hour acc fcst:
2:225707:d=2020101600:APCP:surface:0-1 hour acc fcst:
3:451414:d=2020101600:APCP:surface:0-2 hour acc fcst:
4:726257:d=2020101600:APCP:surface:0-2 hour acc fcst:
5:1001100:d=2020101600:APCP:surface:0-3 hour acc fcst:
6:1307459:d=2020101600:APCP:surface:0-3 hour acc fcst:
7:1613818:d=2020101600:APCP:surface:0-4 hour acc fcst:
8:1940346:d=2020101600:APCP:surface:0-4 hour acc fcst:
9:2266874:d=2020101600:APCP:surface:0-5 hour acc fcst:
10:2610484:d=2020101600:APCP:surface:0-5 hour acc fcst:
11:2954094:d=2020101600:APCP:surface:0-6 hour acc fcst:
12:3311989:d=2020101600:APCP:surface:0-6 hour acc fcst:
14:3894753:d=2020101600:APCP:surface:0-7 hour acc fcst:
16:4539821:d=2020101600:APCP:surface:0-8 hour acc fcst:
18:5222224:d=2020101600:APCP:surface:0-9 hour acc fcst:
20:5934324:d=2020101600:APCP:surface:0-10 hour acc fcst:
22:6672253:d=2020101600:APCP:surface:0-11 hour acc fcst:
24:7431863:d=2020101600:APCP:surface:0-12 hour acc fcst:
26:8071608:d=2020101600:APCP:surface:0-13 hour acc fcst:
28:8767119:d=2020101600:APCP:surface:0-14 hour acc fcst:
30:9496847:d=2020101600:APCP:surface:0-15 hour acc fcst:
32:10253719:d=2020101600:APCP:surface:0-16 hour acc fcst:
34:11034026:d=2020101600:APCP:surface:0-17 hour acc fcst:
36:11835057:d=2020101600:APCP:surface:0-18 hour acc fcst:
38:12515832:d=2020101600:APCP:surface:0-19 hour acc fcst:
40:13250721:d=2020101600:APCP:surface:0-20 hour acc fcst:
42:14017034:d=2020101600:APCP:surface:0-21 hour acc fcst:
44:14807995:d=2020101600:APCP:surface:0-22 hour acc fcst:
46:15623322:d=2020101600:APCP:surface:0-23 hour acc fcst:
48:16460745:d=2020101600:APCP:surface:0-1 day acc fcst:
50:17171481:d=2020101600:APCP:surface:0-25 hour acc fcst:
52:17933059:d=2020101600:APCP:surface:0-26 hour acc fcst:
54:18724060:d=2020101600:APCP:surface:0-27 hour acc fcst:
56:19538757:d=2020101600:APCP:surface:0-28 hour acc fcst:
58:20377109:d=2020101600:APCP:surface:0-29 hour acc fcst:
</pre>

As you can see, 0-1, 0-2, 0-3, 0-4, 0-5 and 0-6 accumulations are duplicated.
<p>
The <font color=brown>-unmerge_fcst</font> option is used to find the precipitation time series.

<pre>
$ wgrib2 all_apcpc.grb -unmerge_fcst precip_ts.grb 0hr 1
1:0:d=2020101600:APCP:surface:0-1 hour acc fcst:
2:225707:d=2020101600:APCP:surface:0-1 hour acc fcst:
3:451414:d=2020101600:APCP:surface:0-2 hour acc fcst:
4:726257:d=2020101600:APCP:surface:0-2 hour acc fcst:
5:1001100:d=2020101600:APCP:surface:0-3 hour acc fcst:
6:1307459:d=2020101600:APCP:surface:0-3 hour acc fcst:
...
</pre>

<p>
The first argument is the output file. The second argument is
the start of the accumulations to start, i.e., 0hr.  Finally the
third argument is 1 to include the 0-1 accumulation.  The output is

<pre>
$ wgrib2 precip_ts.grb 
1:0:d=2020101600:APCP:surface:0-1 hour acc fcst:
2:225707:d=2020101600:APCP:surface:1-2 hour acc fcst:
3:2302390:d=2020101600:APCP:surface:2-3 hour acc fcst:
4:2302593:d=2020101600:APCP:surface:3-4 hour acc fcst:
5:2302796:d=2020101600:APCP:surface:4-5 hour acc fcst:
,,
26:2307059:d=2020101600:APCP:surface:25-26 hour acc fcst:
27:2307262:d=2020101600:APCP:surface:26-27 hour acc fcst:
28:2307465:d=2020101600:APCP:surface:27-28 hour acc fcst:
29:2307668:d=2020101600:APCP:surface:28-29 hour acc fcst:
</pre>


<h3>Usage</h3>
<p>

<pre>
-unmerge_fcst (output file) (N)(time unit) I
   output file: name of output grib file
   N: integer,  usually 0
   time unit:  the forecast time unit, hr, dy, mo, etc
      If you want to process A-B hour acc fcst
      then N=1, time unit = hr
  I = 1 
</pre>

<p>
See also: 
</td>
</tr>


<!--  End of Content area  -->
<!--   ...............................................Footer Portion.........................................    -->
 <tr>
  <td>
   <table width="500">
    <tr>
     <td colSpan="3"><hr></td>
    </tr>
    <TR vAlign="top">
     <TD class="gray">
      <A href="https://www.noaa.gov/" class="homepagelinks"><SPAN class="gray">NOAA/</SPAN></A>
      <A href="https://www.nws.noaa.gov/" class="homepagelinks"><SPAN class="gray">National Weather Service</SPAN></A><BR>
      <A href="https://www.ncep.noaa.gov/" class="homepagelinks"><SPAN class="gray">National Centers for Environmental Prediction</SPAN></a><BR>
        Climate Prediction Center<BR>
        5830 University Research Court<BR>
        College Park, Maryland 20740<BR>
      <A href="/comment-form.html" class="homepagelinks"><SPAN class="gray">Climate Prediction Center Web Team</SPAN></A><BR>
        Page created: Oct 16, 2020
     </TD>
     <TD>
      <A href="https://weather.gov/disclaimer.php" class="homepagelinks"><SPAN class="gray">Disclaimer</SPAN></A>
     </TD>
     <TD align="right">
      <A href="https://weather.gov/privacy.php" class="homepagelinks"> <SPAN class="gray">Privacy Policy</SPAN></A>
     </TD>
    </TR>
   </table>
  </td>
 </tr>
</table>
</td>
</tr>
</table>
</body>
</html>


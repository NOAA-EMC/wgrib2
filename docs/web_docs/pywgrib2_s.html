<!iOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
  <title>Climate Prediction Center - pywgrib2_s: top page</title>
  <meta http-equiv=Content-Type content="text/html; charset=windows-1252">
  <meta content="NCEP Web Team" name="GENERATOR">
  <meta name="keywords"
  content="Climate,Climate Prediction Center,National Weather Service,National Oceanic &amp; Atmospheric Administration, NOAA,El Nino,La Nina,ENSO,climate outlooks,El Nino Advisory,La Nina Advisory,droughts,hurricanes,Threats Assessment,Drought Assessment,Drought Monitor,CLimate Diagnostics Bulletin,6-10 day outlook,8-14 day outlook, 6-10 day forecast,8-14 day forecast,MRF,UV Index,North Atlantic Oscillation,NAO,Pacific Decadal Oscillation,PDO,sea surface temperatures,SST,Palmer Drought Severity Index, African Desk,outlooks,expert assessments,monitoring,advisories,stratosphere,temperature,precipitation,snow cover,snowfall,soil moisture,OLR,ozone,degree days,CLIMATE,CLIMATE PREDICTION CENTER,EL NINO,LA NINA, CLIMATE OUTLOOKS,HURRICANES,ASSESSMENTS,SNOW,STRATOSPHERE,DROUGHT,OZONE,DEGREE DAYS">
  <link href="/nwscwi/main.css" type="text/css" rel="STYLESHEET">
</head>
<body leftmargin="0" background="/nwscwi/background.gif" 
      topmargin="0" rightmargin="0" marginheight="0" marginwidth="0">
<table cellspacing="0" cellpadding="0" width="100%" background="/nwscwi/topbanner.jpg" border="0">
  <tr>
    <td align="right" height="19">
      <a href="#contents"><img height="1" alt="Skip Navigation Links"
         src="/nwscwi/skipgraphic.gif" width="1" border="0"></a>
      <a href="https://www.nws.noaa.gov/" class="homepagelinks"><span class="nwslink">www.nws.noaa.gov</span></a>&nbsp;</td>
  </tr>
</table>
<table cellspacing="0" cellpadding="0" width="100%" border="0">
  <tr>
    <td rowspan="2"><a href="https://www.noaa.gov/">
      <img height="78" alt="NOAA logo - Click to go to the NOAA home page"
      src="/nwscwi/noaaleft.jpg" width="85" border="0"></a></td>
    <td align="left"><img height="20" alt="National Weather Service"
      src="/nwscwi/nws_title.jpg" width="500" border="0"></td>
    <td rowspan="2" width="100%" background="/nwscwi/ncep_bkgrnd.jpg">&nbsp;</td>
    <td rowspan="2" align="right"><a href="https://www.nws.noaa.gov/">
      <img height="78" alt="NWS logo - Click to go to the NWS home page"
      src="/nwscwi/nwsright.jpg" width="85" border="0"></a></td>
  </tr>
  <tr>
    <td><img height="58" alt="Climate Prediction Center" src="/nwscwi/cpc.jpg"
             width="500" border="0"></td>    <!-- Put your center header image here. -->
  </tr>
</table>
<table cellspacing="0" cellpadding="0" width="100%" background="/nwscwi/navbkgrnd.gif" border="0">
  <tr>
    <td align="left" valign="top" width="94"><img height="23" alt="" src="/nwscwi/navbarleft.jpg" width
="94" border="0"></td>
    <td class="nav" align="center" width="15%">
      <a href="/products/site_index.html" class="menu">Site Map</a></td> <!-- Build a text only sitemap, and link to it via this
                                                    sitemap button just below the banner.
                                                    The sitemap should include a heirarchy of links
                                                    from NOAA, to the NWS, to NCEP, and then through your site. -->
    <td class="nav" align="right" width="15%">
      <a href="https://www.nws.noaa.gov/pa/" class="menu">News</a></td>
    <td class="nav" id="menuitem" align="right" width="20%">
      <a href="https://weather.gov/organization.php" class="menu">Organization</a></td>
    <td class="yellow" align="right" width="20%">
      <form action="https://www.firstgov.gov/fgsearch/index.jsp" name="query">
        <label for="search">Search</label>&nbsp;</td>
    <td align="left" class="searchinput" width="20%" nowrap>
      <input type="hidden" name="parsed" value="true">
      <input type="hidden" name="rn" value="3">
      <input type="hidden" name="in0" value="domain">
      <input type="hidden" name="dom0" value="nws.noaa.gov, weather.gov, wrh.noaa.gov, srh.noaa.gov, crh.noaa.gov, prh.noaa.gov, arh.noaa.gov, alaska.net/~nwsar, erh.noaa.gov, ncep.noaa.gov, wwb.noaa.gov, spc.noaa.gov, nhc.noaa.gov, sec.noaa.gov, aviationweather.gov, aviationweather.noaa.gov, weather.noaa.gov, roc.noaa.gov, nohrsc.nws.gov, nwstc.noaa.gov, wdtb.noaa.gov, npmoc.navy.mil, ndbc.noaa.gov">
      <input type="text" name="mw0" value="All NWS Search" id="search" size="20" maxlength="256">
      <input type="submit" name="Go2" value="Go"></td>
    <td width="10%">&nbsp;</form></td>
    <td align="right" valign="bottom" width="24"><img height="23" alt="" src="/nwscwi/navbarendcap.jpg"
 width="24" border="0"></td>
  </tr>
</table>
<table cellspacing="0" cellpadding="0" width="670" border="0">
  <tr valign="top">
    <td width="137"><br>
      <table cellspacing="0" cellpadding="2" width="137" border="0">
        <!-- Do not remove this section. You will need this when the City,St/zip search is implemented nationwide.-->
        <!-- <tr align="left" valign="top">
                <td class="searchinput">
                  <div id="Layer2" style="position:absolute; width:200px; height:115px; z-index:2; visibility: hidden">Search by city or zip code. Press enter or select the go button to submit request</div>
                  <form method="POST" action="https://www.srh.noaa.gov/zipcity.php">
                  <span class="yellow">Local forecast by<br>&quot;City, St&quot; or Zip Code</span><br>
                  <input type="text" name="inputstring" size="9" value="City, St">
                  <input type="submit" name="Go2" value="Go"></form></td>
        </tr> -->
         <tr>
          <td class="searchinput" align="left">
            <form action="https://www.firstgov.gov/fgsearch/index.jsp" name="query">
             <label for="search"><span class="yellow">CPC Search</span></label>
              <input type="hidden" name="parsed" value="true">
              <input type="hidden" name="rn" value="3">
              <input type="hidden" name="in0" value="domain">
              <input type="hidden" name="dom0" value="www.cpc.ncep.noaa.gov">
              <input type="text" name="mw0" id="search"  size="10" maxLength="256" value="CPC search">&nbsp;
              <input type="submit" name="Go2" value="Go">
          </form></td>
         </tr>
        <tr>
          <td class="white">
            <span class="yellow">About Us</span><br>
            &nbsp;&nbsp;&nbsp;<a href="/information/who_we_are/mission.html" class="menu">Our Mission</a><br>
            &nbsp;&nbsp;&nbsp;<a href="/information/who_we_are/" class="menu">Who We Are</a><br><br>
            <span class="yellow">Contact Us</span><br>
            &nbsp;&nbsp;&nbsp;<a href="/information/personnel/contacts.html" class="menu">CPC Information</a><br>
            &nbsp;&nbsp;&nbsp;<a href="/comment-form.html" class="menu">CPC Web Team</a><br><br>           
          </td>
        </tr>
      </table>
    </td>
    <td valign="top" align="center" width="533"><a name="contents"></a>

<!-- Begin content area -->

<table border="0" cellPadding="2" cellSpacing="0" align="center" width="533">
 <tr><td>&nbsp;</td></tr>
 <tr>
  <td>
   <font face="Verdana,arial,serif" size="1"><a href="/index.html" class="homepagelinks"><strong>HOME</strong></a> &gt; <a href="/products/monitoring_and_data" class="homepagelinks">Monitoring_and_Data</a> &gt; <a href="/products/monitoring_and_data/oadata.html" class="homepagelinks">Oceanic and Atmospheric Data</a> &gt; <a href="/products/wesley/" class="homepagelinks">Reanalysis: Atmospheric Data</a> &gt; pywgrib2_s:</font>
  </td>
 </tr>
 <tr><td>&nbsp;</td></tr>
 <tr>
  <td>
<font color=red>
<h3 align=center>pywgrib2_s: Home Page </h3>
</font>


<h3>Introduction</h3>

<p>
Pywgrib2_s is a python package for reading and writing grib2 which is a World
Meterological Organization (WMO) format for exchanging meteorological and oceanographic
gridded data. The specifications for the grib2 (grib version 2) format are available from
the WMO, and several libraries are available for reading and writing grib2.  Pywgrib2_s
is based on the fortran wgrib2api and the wgrib2 library.

<p> The design goals of pywgrib2_s are a simple interface, minimal requirements for
additional python modules/packages, and the ability to program for efficient I/O.
Since pywgrib2_s is uses the wgrib2 library, search terms are based on wgrib2 terms.
For example, searching for the 2 meter temperature is done by, var="TMP", lev="2 m above ground".

<p> 8/2020:  I am using the alpha pywgrib2_s in my work, with no problems.  The problems
that I am using it are a bit too complicated for a wgrib2 script, and not so resource
intensive that I that I need fortran.


<h3>Basics: Grib Data Model</h3>

<p>  The grib data model is more complicated than the data model for the natural world.
For example, the earth's temperature is defined by a location and time (x,y,z,t).  Grib was developed
for forecast centers has more characteristics such as forecast time, averaging period,
ensemble member, and numerical model that created the forecast.  When you consider
tracer gases, you add chemical type.  Aerosols add the composition and size of the pariculate matter.
Forecasts can be deterministic or probabalistic.  


<p> Grib files often have multiple vertical coordinate systems.  Meteorologists often
use pressure or isentropic coordinates.  The aviation community often use height above a
constant geopotential.  The people on the ground often want meters above ground.
The ocean fields and soil fields will have their own vertical coordinates.

<p> A grib file does not include an index, usually a software package includes
a mechanism for making an index file.  Pywgrib2_s uses the human-readable wgrib2
inventory.  Not having a included index has its advantages and disavantages.
Having a human-readable index has been very advantageous.

<p>
A grib field has many characteristics to uniquely identify it.  So pywgrib2_s has
taken the approach that characteristics of the field will be text string which
grow in time as the grib standard adds more characteristics.  To find a field, 
you provide search terms that compared with the inventory.  


<h3>Naming Convention</h3>
<p>
Grib is an international standard which doesn't specify a naming standard.  For
example a pressure surface of 1000 Pascals, could be called "10 mb" (non-SI unit),
"10 hPa" (used in scientific literature), "1 kPa" (SI unit) or even 0.2953 inch of nercury.
At NCEP, geopotential height has the name HGT.  This is a local convention.
Pywgrib2_s, like wgrib2, use the NCEP <a href='https://www.nco.ncep.noaa.gov/pmb/docs/grib2/grib2_doc/'>
NCEP naming convention</a>.  Grib allows locally defined tables, and pywgrib_s/wgrib2 wgrib2 
follows the recommendation of the defining site.



<h3>Reading and Writing Grib</h3>

<pre>
 <a href='./pywgrib2_s_mk_inv.html'>mk_inv(grib, inv_file)</a>                   makes inventory file
 <a href='./pywgrib2_s_read_inv.html'>read_inv(inv_file)</a>                       reads inventory file, returns list
 <a href='./pywgrib2_s_inq.html'>inq(grib,...)</a>                            inquire about grib2 file
                                            read metadata, grid point data,
                                            calculate lat-lon of grid points for common grids
 <a href='./pywgrib2_s_write.html'>write(grib,...)</a>                          write grib2
 <a href='./pywgrib2_s_close.html'>close(file)</a>                              close file, used to flush, free up resources,
</pre>

<h3>Memory Files</h3>
The above routines read and write files.  Using the the filesystem would be a bottleneck for many
applications, so wgrib2 added memory files. These memory files resided in the memory space
of wgrib2 and can be accessed from python.

<pre>
 memory file:  @mem:N   N = 0,1,..,29   memory files 10-29 are reserved for use by pywgrib2_s

 get_bytes_mem(fileno)                    returns bytes (buffer) from from memory file number "fileno"
 get_dbl_mem(fileno)                      reserved for future use
 get_flt_mem(fileno)                      returns numpy.ndarray (numpy array) with float32 values
 get_str_mem(fileno)                      returns text string from memory file number "fileno"
 mem_size(fileno)                         returns size of memory file number "fileno" in bytes
 set_mem(fileno,buffer)                   copy buffer to memory file number "fileno"
                                          buffer can be type bytes, str or numpy.ndarray
                                          set_mem(12,'') will empty @mem:12
</pre>
<h3>Multi-Threading</h3>
Pywgrib2_s uses the multi-threaded wgrib2 library to speed up execution.  You control the number
of threads by setting the environment variable OMP_NUM_THREADS.  You rarely set the number
of threads greater than 5 because the speedup becomes minor in most cases.  

<p>
There are a few wgrib2 operations that can use as many cores as possible
(ex. -ensemble processing, -lola for certain grids).  For calls to wgrib2(..),
the number of threads can be controlled by -ncpu option.

<h3>Global Variables</h3>

<p> Pywgrib2_s uses global variables for the 

<ol>
<li>  <a href="./pywgrib2_s_global_variables.html">configuration</a>
<li> 
<a href="./pywgrib2_s_global_variables.html">output of pywgrib2_s.inq(..)</a>
</ol>

<h3>Low level Access: wgrib2</h3>
<p>
The pywgrib2_s is a python module that calls wgrib2.  Sometimes you may
need to know the version and configuration of the wgrib2 library.  
The pywgrib2_s.wgrib2(..) will let you directly call wgrib2.


<pre>
 wgrib2_version()                           returns a string with the version of the
                                            wgrib2 library. Same as wgrib2 -version

 wgrib2_config()                            returns list of strings with the configuration 
                                            of the wgrib2 library. Same as wgrib2 -config

 <a href='./pywgrib2_s_wgrib2.html'>wgrib2( [ (list of wgrib2 arguments) ] )</a>   call wgrib2


</pre>

<h3>Low Level Access: Registers</h3>
Registers are part of the reverse polish notation calculator (-rpn).  They are used by the internals 
of pywgrib2_s, and should only be used by programs that make direct calls to wgrib2.

<pre>
 reg_size(regno)                            returns size of register number "regno" in elements
 reg_shape(regno)                           reserved for future use
 get_flt_reg(regno)                         returns numpy.ndarray (numpy array) with floating point 32 value
 get_dbl_reg(regno)                         reserved for future use
 set_reg(regno, array)                      copy array (numpy.ndarray) to RPN register "regno"
</pre>

<h3>Requirements: </h3>

<p> The requirements for pywgrib2_s are

<ol>
<li> python 3.5+, numpy
<li> Linux (tested: Ubuntu, Redhat, SUSE), MacOS, Windows (tested: Cygwin-64)
<li> shared wgrib2 library created using wgrib2 v3.0.2
<li> Linux compilers: gcc/gfortran, AOCC clang/flang, NVidia HPD sdk nvc/nvfortran
<li> MacOS compilers: homebrew gcc/gfortran (gcc may be a wrapper for clang)
<li> Windows compilers: cygwin gcc/gfortran
</ol>

<h3>Cookbook</h3>

<p> A living cookbook of pywgrib2_s "recipes" is being maintained.
The cookbook serves as a learning tool for beginners, a simple
validation tool, testbed for testing the utility of the API, and
and starting point for writing some code.

Li Xu of CPC has provided some documentation for the 
<a href='https://www.cpc.ncep.noaa.gov/products/people/lxu/cookbook/'>cookbook</a> and pywgrib2_s routines.





<h3>Installation:</h3>

See <a href="./pywgrib2_s_install.html">Installation directions</a>


<h3>Code Timeline</h3>
<ul>
 <li> wgrib2: released 2004
 <li> wgrib2 can be built as subroutine that can be called from C or Fortran, wgrib2 library (2015)
 <li> alpha version of pywgrib2 using wgrib2 library by George Trojan (2/2020)
 <li> wgrib2 v3.0.0 with alpha-beta pywgrib2_s (9/2020) and pywgrib2_xr afterwards
 <li> wgrib2 v3.0.2 with updates for pywgrib2_* including Windows support (3/2021)
</ul>

<p>
See also: 
<a href='./pywgrib2_s_conventions.html'>pywgrib2_s conventions</a>
</td>
</tr>


<!--  End of Content area  -->
<!--   ...............................................Footer Portion.........................................    -->
 <tr>
  <td>
   <table width="500">
    <tr>
     <td colSpan="3"><hr></td>
    </tr>
    <TR vAlign="top">
     <TD class="gray">
      <A href="https://www.noaa.gov/" class="homepagelinks"><SPAN class="gray">NOAA/</SPAN></A>
      <A href="https://www.nws.noaa.gov/" class="homepagelinks"><SPAN class="gray">National Weather Service</SPAN></A><BR>
      <A href="https://www.ncep.noaa.gov/" class="homepagelinks"><SPAN class="gray">National Centers for Environmental Prediction</SPAN></a><BR>
        Climate Prediction Center<BR>
        5830 University Research Court<BR>
        College Park, Maryland 20740<BR>
      <A href="/comment-form.html" class="homepagelinks"><SPAN class="gray">Climate Prediction Center Web Team</SPAN></A><BR>
        Created: Aug 11, 2020, Modified: 6/2021, 7/2021
     </TD>
     <TD>
      <A href="https://weather.gov/disclaimer.php" class="homepagelinks"><SPAN class="gray">Disclaimer</SPAN></A>
     </TD>
     <TD align="right">
      <A href="https://weather.gov/privacy.php" class="homepagelinks"> <SPAN class="gray">Privacy Policy</SPAN></A>
     </TD>
    </TR>
   </table>
  </td>
 </tr>
</table>
</td>
</tr>
</table>
</body>
</html>

